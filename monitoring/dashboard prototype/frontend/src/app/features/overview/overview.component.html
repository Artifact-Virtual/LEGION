<div class="overview-container">
  <!-- Header -->
  <div class="header">
    <h1>System Overview</h1>
    <button mat-icon-button (click)="refreshData()" [disabled]="loading">
      <mat-icon>refresh</mat-icon>
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <mat-icon color="warn">error</mat-icon>
    <p>{{ error }}</p>
    <button mat-raised-button color="primary" (click)="refreshData()">
      Retry
    </button>
  </div>

  <!-- Main Dashboard Content -->
  <div *ngIf="!loading && !error" class="dashboard-content">
    
    <!-- Quick Stats Row -->
    <div class="stats-row">
      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>System Health</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-content">
            <mat-icon [style.color]="getStatusColor(systemHealth)">
              {{ systemHealth === 'healthy' ? 'check_circle' : systemHealth === 'warning' ? 'warning' : 'error' }}
            </mat-icon>
            <span class="stat-value">{{ systemHealth | titlecase }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>Active Adapters</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-content">
            <mat-icon>device_hub</mat-icon>
            <span class="stat-value">{{ getConnectedAdaptersCount() }}/{{ getAdaptersCount() }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>Data Points</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-content">
            <mat-icon>timeline</mat-icon>
            <span class="stat-value">{{ totalMetrics | number }}</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-header>
          <mat-card-title>Active Alerts</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="stat-content">
            <mat-icon [color]="activeAlerts > 0 ? 'warn' : 'primary'">notifications</mat-icon>
            <span class="stat-value">{{ activeAlerts }}</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- System Status & Adapters Row -->
    <div class="content-row">
      <!-- System Status -->
      <mat-card class="system-status-card">
        <mat-card-header>
          <mat-card-title>System Status</mat-card-title>
          <mat-card-subtitle *ngIf="systemStatus">
            Uptime: {{ systemStatus.uptime | number:'1.0-0' }}s | Version: {{ systemStatus.version }}
          </mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div *ngIf="systemStatus" class="system-components">
            <div *ngFor="let component of systemStatus.components" class="component-item">
              <mat-icon [style.color]="getStatusColor(component.status)">
                {{ getAdapterStatusIcon(component.status) }}
              </mat-icon>
              <span class="component-name">{{ component.name }}</span>
              <span class="component-status">{{ component.status | titlecase }}</span>
              <span *ngIf="component.message" class="component-message">{{ component.message }}</span>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Adapters Overview -->
      <mat-card class="adapters-card">
        <mat-card-header>
          <mat-card-title>Data Adapters</mat-card-title>
          <mat-card-subtitle>{{ adapters.length }} total adapters</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="adapters-list">
            <div *ngFor="let adapter of adapters" class="adapter-item">
              <mat-icon [style.color]="getStatusColor(adapter.status)">
                {{ getAdapterStatusIcon(adapter.status) }}
              </mat-icon>
              <div class="adapter-info">
                <span class="adapter-name">{{ adapter.name }}</span>
                <span class="adapter-status">{{ adapter.status | titlecase }}</span>
                <div *ngIf="adapter.metrics" class="adapter-metrics">
                  Queries: {{ adapter.metrics.queries }} | 
                  Data Points: {{ adapter.metrics.dataPoints }} |
                  Errors: {{ adapter.metrics.errors }}
                </div>
              </div>
            </div>
          </div>
          <div class="adapter-actions">
            <button mat-stroked-button routerLink="/adapters">
              Manage Adapters
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Recent Alerts -->
    <mat-card class="alerts-card" *ngIf="alerts.length > 0">
      <mat-card-header>
        <mat-card-title>Recent Alerts</mat-card-title>
        <mat-card-subtitle>{{ alerts.length }} alerts</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="alerts-list">
          <div *ngFor="let alert of alerts" class="alert-item" [class.acknowledged]="alert.acknowledged">
            <mat-icon [color]="alert.type === 'critical' ? 'warn' : alert.type === 'error' ? 'warn' : 'primary'">
              {{ alert.type === 'critical' ? 'warning' : alert.type === 'error' ? 'error' : 'info' }}
            </mat-icon>
            <div class="alert-content">
              <div class="alert-title">{{ alert.title }}</div>
              <div class="alert-message">{{ alert.message }}</div>
              <div class="alert-meta">
                <span class="alert-source">{{ alert.source }}</span>
                <span class="alert-time">{{ alert.timestamp | date:'short' }}</span>
              </div>
            </div>
            <div class="alert-actions">
              <button *ngIf="!alert.acknowledged" 
                      mat-icon-button 
                      (click)="acknowledgeAlert(alert)"
                      matTooltip="Acknowledge">
                <mat-icon>check</mat-icon>
              </button>
            </div>
          </div>
        </div>
        <div class="alerts-actions">
          <button mat-stroked-button routerLink="/system/alerts">
            View All Alerts
          </button>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Quick Actions -->
    <mat-card class="quick-actions-card">
      <mat-card-header>
        <mat-card-title>Quick Actions</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="quick-actions">
          <button mat-raised-button color="primary" routerLink="/metrics">
            <mat-icon>timeline</mat-icon>
            View Metrics
          </button>
          <button mat-raised-button color="primary" routerLink="/logs">
            <mat-icon>description</mat-icon>
            View Logs
          </button>
          <button mat-raised-button color="primary" routerLink="/reports">
            <mat-icon>assessment</mat-icon>
            Generate Report
          </button>
          <button mat-raised-button color="primary" routerLink="/automation">
            <mat-icon>smart_toy</mat-icon>
            Automation
          </button>
          <button mat-raised-button color="accent" routerLink="/registry">
            <mat-icon>api</mat-icon>
            API Registry
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<div class="automation-container">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Automation</mat-card-title>
      <mat-card-subtitle>Manage automated tasks and workflows</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <!-- Create automation section -->
      <div class="create-automation">
        <h3>Create New Automation</h3>
        <div class="creation-controls">
          <mat-form-field appearance="outline">
            <mat-label>Automation Name</mat-label>
            <input matInput [(ngModel)]="newAutomationName" placeholder="Enter automation name">
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Trigger Type</mat-label>
            <mat-select [(value)]="selectedTriggerType">
              <mat-option value="schedule">Schedule</mat-option>
              <mat-option value="threshold">Threshold</mat-option>
              <mat-option value="event">Event</mat-option>
              <mat-option value="webhook">Webhook</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Action Type</mat-label>
            <mat-select [(value)]="selectedActionType">
              <mat-option value="email">Send Email</mat-option>
              <mat-option value="restart">Restart Service</mat-option>
              <mat-option value="scale">Scale Resources</mat-option>
              <mat-option value="script">Run Script</mat-option>
            </mat-select>
          </mat-form-field>

          <button mat-raised-button color="primary" (click)="createAutomation()">
            <mat-icon>add</mat-icon>
            Create
          </button>
        </div>
      </div>

      <mat-divider></mat-divider>

      <!-- Automations list -->
      <div class="automations-list">
        <h3>Active Automations</h3>
        <mat-table [dataSource]="automations" class="automations-table">
          <ng-container matColumnDef="name">
            <mat-header-cell *matHeaderCellDef>Name</mat-header-cell>
            <mat-cell *matCellDef="let automation">{{ automation.name }}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="trigger">
            <mat-header-cell *matHeaderCellDef>Trigger</mat-header-cell>
            <mat-cell *matCellDef="let automation">{{ automation.trigger_type }}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="action">
            <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
            <mat-cell *matCellDef="let automation">{{ automation.action_type }}</mat-cell>
          </ng-container>

          <ng-container matColumnDef="status">
            <mat-header-cell *matHeaderCellDef>Status</mat-header-cell>
            <mat-cell *matCellDef="let automation">
              <mat-chip [ngClass]="'status-' + automation.status">{{ automation.status }}</mat-chip>
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="lastRun">
            <mat-header-cell *matHeaderCellDef>Last Run</mat-header-cell>
            <mat-cell *matCellDef="let automation">
              {{ automation.last_run ? (automation.last_run | date:'medium') : 'Never' }}
            </mat-cell>
          </ng-container>

          <ng-container matColumnDef="actions">
            <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
            <mat-cell *matCellDef="let automation">
              <button mat-icon-button (click)="toggleAutomation(automation)">
                <mat-icon>{{ automation.status === 'active' ? 'pause' : 'play_arrow' }}</mat-icon>
              </button>
              <button mat-icon-button (click)="editAutomation(automation)">
                <mat-icon>edit</mat-icon>
              </button>
              <button mat-icon-button (click)="deleteAutomation(automation)">
                <mat-icon>delete</mat-icon>
              </button>
            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
        </mat-table>
      </div>
    </mat-card-content>
  </mat-card>
</div>
